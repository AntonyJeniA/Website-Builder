<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Visual Web Builder Initialization</title>
    <link rel="stylesheet" href="styles/main.css">
    <style>
        .test-container {
            padding: 20px;
            font-family: system-ui, sans-serif;
        }

        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>

<body>
    <div class="test-container">
        <h1>Visual Web Builder - Initialization Test</h1>
        <div id="test-results"></div>

        <!-- Minimal required DOM structure -->
        <div class="app-container" style="display: none;">
            <header class="app-header">
                <h1>Visual Web Builder</h1>
                <div class="header-controls">
                    <button id="save-btn" class="btn btn-primary">Save</button>
                    <button id="load-btn" class="btn btn-secondary">Load</button>
                    <button id="export-btn" class="btn btn-secondary">Export</button>
                    <button id="preview-window-btn" class="btn btn-secondary">Preview Window</button>
                    <button id="demo-btn" class="btn btn-accent">Demo</button>
                </div>
            </header>
            <main class="main-content">
                <aside class="left-panel" id="element-library">
                    <h2>Elements</h2>
                </aside>
                <section class="center-panel">
                    <div class="canvas-container">
                        <div class="canvas" id="main-canvas"></div>
                    </div>
                </section>
                <aside class="right-panel" id="property-editor">
                    <h2>Properties</h2>
                </aside>
            </main>
        </div>
    </div>

    <!-- Load JavaScript files -->
    <script src="js/utils/EventBus.js"></script>
    <script src="js/utils/DOMUtils.js"></script>
    <script src="js/core/ErrorHandler.js"></script>
    <script src="js/core/FallbackManager.js"></script>
    <script src="js/core/PanelManager.js"></script>
    <script src="js/core/ElementLibrary.js"></script>
    <script src="js/core/DragDropEngine.js"></script>
    <script src="js/core/CanvasManager.js"></script>
    <script src="js/core/PropertyEditor.js"></script>
    <script src="js/core/PreviewManager.js"></script>
    <script src="js/core/StorageManager.js"></script>
    <script src="js/core/ExportEngine.js"></script>
    <script src="js/core/ResponsiveManager.js"></script>
    <script src="js/core/AdvancedManipulation.js"></script>
    <script src="js/core/UXEnhancement-simple.js"></script>
    <script src="js/core/VisualWebBuilder.js"></script>

    <script>
        function addTestResult(message, type) {
            const results = document.getElementById('test-results');
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.textContent = message;
            results.appendChild(div);
        }

        function runTests() {
            addTestResult('Starting initialization tests...', 'info');

            try {
                // Test EventBus
                addTestResult('‚úì Testing EventBus...', 'info');
                const eventBus = new EventBus();
                addTestResult('‚úì EventBus created successfully', 'success');

                // Test DOMUtils
                addTestResult('‚úì Testing DOMUtils...', 'info');
                const testElement = DOMUtils.createElement('div', { className: 'test' });
                addTestResult('‚úì DOMUtils working correctly', 'success');

                // Test VisualWebBuilder
                addTestResult('‚úì Testing VisualWebBuilder creation...', 'info');
                const app = new VisualWebBuilder();
                addTestResult('‚úì VisualWebBuilder created successfully', 'success');

                // Test initialization
                addTestResult('‚úì Testing VisualWebBuilder initialization...', 'info');
                app.init();
                addTestResult('‚úì VisualWebBuilder initialized successfully!', 'success');

                // Make globally available
                window.visualWebBuilder = app;

                addTestResult('üéâ All tests passed! The application should now work correctly.', 'success');

            } catch (error) {
                addTestResult('‚ùå Test failed: ' + error.message, 'error');
                console.error('Test error:', error);
                console.error('Stack trace:', error.stack);
            }
        }

        // Run tests when DOM is ready
        document.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>

</html>